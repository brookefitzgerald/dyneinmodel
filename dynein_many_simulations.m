%% potential improvements to the model:% incorporate random releasing of the track% incorporate y movement% incorporate responsive %% constantssteps_per_second = 17;distance_per_step = 8; %nanometersrun_length = 1000; %nanometersseconds_to_simulate = 100;N_steps = steps_per_second*seconds_to_simulate;%% parameters - change thesepause_rate = 0.01; % fraction of time a motor pausespause_duration = 3; % how many steps pausemax_distance_between_motors = 3; % nanometerspossible_motors = [2; 4; 7];n_motors = size(possible_motors);n_simulations = 5;max_distance_reached_per_motor = zeros(2,n_motors, n_simulations);for j=1:n_motors    for sim=1:n_simulations        %% initializing variables        number_of_motors = possible_motors(j);        rigid_x_list = zeros(number_of_motors, N_steps);        rigid_x_list(:,1) = (1:number_of_motors)*(max_distance_between_motors-1);                flexible_x_list = zeros(number_of_motors, N_steps);        flexible_x_list(:,1) = (1:number_of_motors)*(max_distance_between_motors-1);        y_list = zeros(number_of_motors, N_steps);        pausing_time_remaining = zeros(1,number_of_motors);        for t=2:N_steps            for i=1:number_of_motors                if pausing_time_remaining(i)>0                    pausing_time_remaining(i) = pausing_time_remaining(i)-1;                elseif rand <=pause_rate                    pausing_time_remaining(i) = pause_duration;                end            end            rigid_x_list(:,t) = rigid_step(pausing_time_remaining, rigid_x_list(:,t-1));            flexible_x_list(:,t) = flexible_step(pausing_time_remaining, flexible_x_list(:,t-1),number_of_motors, max_distance_between_motors);        end                max_distance_reached_per_motor(1,j,sim) = max(rigid_x_list(:,end));        max_distance_reached_per_motor(2,j,sim) = max(flexible_x_list(:,end));            endendmean_speeds = distance_per_step*mean(max_distance_reached_per_motor, 3)/seconds_to_simulate;bar(mean_speeds');legend('rigid','flexible');set(gca,'xticklabel',possible_motors);xlabel('Number of Motors')ylabel('Motor Speed (nm/s)')